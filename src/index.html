<!DOCTYPE html>
<html>
<head>
    <title>Quotes API - Swagger UI</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.14.0/swagger-ui.min.css" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin:0;
            background: #fafafa;
        }
        #error-message {
            display: none;
            padding: 20px;
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef5350;
            border-radius: 4px;
            margin: 20px;
        }
    </style>
</head>
<body>
    <div id="error-message">
        <h3>Error loading Swagger UI</h3>
        <p>There was an issue loading the Swagger interface. Please try refreshing the page.</p>
    </div>
    <div id="swagger-ui"></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.14.0/swagger-ui-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.14.0/swagger-ui-standalone-preset.min.js"></script>
    <script>
        try {
            window.onload = function() {
        const spec = {
                    "openapi": "3.0.0",
                    "info": {
                        "title": "RUSTful API",
            "description": "API for quotes and URL shortening.",
                        "version": "1.0.0"
                    },
                    "tags": [
                        { "name": "Quotes", "description": "Create and retrieve quotes" },
                        { "name": "URL Shortener", "description": "Shorten and resolve URLs" }
                    ],
                    "servers": [
                        {
                            "url": "https://rustful.baileygamesand.codes",
                            "description": "Production"
                        },
                        {
                            "url": "http://localhost:840",
                            "description": "Test server"
                        }
                    ],
                    "paths": {
                        "/quotes": {
                            "post": {
                                "tags": ["Quotes"],
                                "summary": "Create a new quote",
                                "description": "Add a new quote with text and speaker.",
                                "requestBody": {
                                    "required": true,
                                    "content": {
                                        "application/json": {
                                            "schema": {
                                                "type": "object",
                                                "required": ["text", "speaker"],
                                                "properties": {
                                                    "text": { "type": "string" },
                                                    "speaker": { "type": "string" }
                                                }
                                            },
                                            "examples": {
                                                "sheldon": { "summary": "Sheldon", "value": { "text": "Bazinga, punk!", "speaker": "Sheldon Cooper" } },
                                                "leonard": { "summary": "Leonard", "value": { "text": "You may be from Texas but I'm from New Jearsey!", "speaker": "Leonard Hofstadter" } }
                                            }
                                        }
                                    }
                                },
                                "responses": {
                                    "201": {
                                        "description": "Quote created",
                                        "content": {
                                            "application/json": {
                                                "schema": { "$ref": "#/components/schemas/Quote" },
                                                "examples": {
                                                    "created": { "value": { "id": "2c6d2a3d-9a3a-4b5c-8f2f-123456789abc", "text": "Bazinga, punk!", "speaker": "Sheldon Cooper" } }
                                                }
                                            }
                                        }
                                    },
                                    "400": { "description": "Invalid input" }
                                }
                            },
                            "get": {
                                "tags": ["Quotes"],
                                "summary": "List quotes",
                                "description": "Return all quotes.",
                                "responses": {
                                    "200": {
                                        "description": "Array of quotes",
                                        "content": {
                                            "application/json": {
                                                "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Quote" } },
                                                "examples": {
                                                    "list": { "value": [
                                                        { "id": "11111111-1111-1111-1111-111111111111", "text": "Bazinga, punk!", "speaker": "Sheldon Cooper" },
                                                        { "id": "22222222-2222-2222-2222-222222222222", "text": "You may be from Texas but I'm from New Jearsey!", "speaker": "Leonard Hofstadter" }
                                                    ] }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "/quote": {
                            "get": {
                                "tags": ["Quotes"],
                                "summary": "Random quote",
                                "responses": {
                                    "200": { "description": "Random quote", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Quote" }, "examples": { "random": { "value": { "id": "33333333-3333-3333-3333-333333333333", "text": "You may be from Texas but I'm from New Jearsey!", "speaker": "Leonard Hofstadter" } } } } } },
                                    "404": { "description": "No quotes available" }
                                }
                            }
                        },
                        "/quotes/{id}": {
                            "get": {
                                "tags": ["Quotes"],
                                "summary": "Quote by ID",
                                "parameters": [ { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } } ],
                                "responses": {
                                    "200": { "description": "Quote", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Quote" }, "examples": { "found": { "value": { "id": "44444444-4444-4444-4444-444444444444", "text": "Bazinga, punk!", "speaker": "Sheldon Cooper" } } } } } },
                                    "404": { "description": "Not found" }
                                }
                            }
                        },
                        "/shorten": {
                            "post": {
                                "tags": ["URL Shortener"],
                                "summary": "Shorten a URL",
                                "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "required": ["url"], "properties": { "url": { "type": "string" } } }, "examples": { "rust": { "value": { "url": "https://www.rust-lang.org" } }, "actix": { "value": { "url": "https://actix.rs" } } } } } },
                                "responses": { "200": { "description": "Short URL created", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ShortenResponse" }, "examples": { "short": { "value": { "short": "a1b2c", "url": "https://www.rust-lang.org" } } } } } } }
                            }
                        },
                        "/path/{short}": {
                            "get": {
                                "tags": ["URL Shortener"],
                                "summary": "Redirect short URL",
                                "parameters": [ { "name": "short", "in": "path", "required": true, "schema": { "type": "string" }, "examples": { "ex": { "value": "a1b2c" } } } ],
                                "responses": { "302": { "description": "Redirect to original URL (Location header)" }, "404": { "description": "Short code not found" } }
                            }
                        }
                    }
                ,
                "components": {
                    "schemas": {
                        "Quote": {
                            "type": "object",
                            "properties": {
                                "id": { "type": "string", "description": "UUID" },
                                "text": { "type": "string" },
                                "speaker": { "type": "string" }
                            },
                            "required": ["id", "text", "speaker"],
                            "example": { "id": "uuid-example", "text": "Bazinga, punk!", "speaker": "Sheldon Cooper" }
                        },
                        "ShortenResponse": {
                            "type": "object",
                            "properties": {
                                "short": { "type": "string", "description": "Short code" },
                                "url": { "type": "string", "description": "Original URL" }
                            },
                            "required": ["short", "url"],
                            "example": { "short": "abc12", "url": "https://www.rust-lang.org" }
                        }
                    }
                }
                };

                const ui = SwaggerUIBundle({
                    spec: spec,
                    dom_id: '#swagger-ui',
                    deepLinking: true,
                    presets: [
                        SwaggerUIBundle.presets.apis,
                        SwaggerUIStandalonePreset
                    ],
                    plugins: [
                        SwaggerUIBundle.plugins.DownloadUrl
                    ],
                    layout: "StandaloneLayout",
                    tryItOutEnabled: true
                });
            };
        } catch (error) {
            console.error('Error initializing Swagger UI:', error);
            document.getElementById('error-message').style.display = 'block';
            document.getElementById('swagger-ui').style.display = 'none';
        }
    </script>
</body>
</html>